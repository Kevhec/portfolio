---
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets'
import { getLangFromUrl, useTranslations } from '@i18n/utils'
import _slug_ from 'src/pages/[lang]/project/[slug].astro';
import CustomImage from '@components/CustomImage.astro';
import Container from '@components/Container.astro';
import Typography from '@components/Typography.astro';
import ProjectCard from '@components/ProjectCard.astro';

const pageLang = getLangFromUrl(Astro.url);
const t = useTranslations(pageLang);

const projects = await getCollection('projects', ({ slug }) => {
  const [projectLang, _] = slug.split('/');
  return projectLang === pageLang;
});
---
<Container>
  <div class="projects__innerContainer">
    <Typography as='h2' class="projects__heading line-height-1">
      {t("projects.heading")}
    </Typography>
    <ul class="projects">
      {
        projects.map((project) => (
          <li>
            <div>
              <CustomImage
                mobileImgUrl={project.data.mockup}
                desktopImgUrl={project.data.mockup}
                alt={project.data.mockupAlt}
              />
              <Typography as="h3" class="projectCard__heading">
                {project.data.projectName}
              </Typography>
              <Typography as="p" class="projectCard__excerpt">
                {project.data.excerpt}
              </Typography>
              <a
                href={`/${pageLang}/project/${project.slug.split('/').slice(1)}`}
                class="projectCard__link"
              >
                {t("projects.seeProjectLabel")}
              </a>
            </div>
          </li>
        ))
      }
    </ul>
  </div>
</Container>

<style lang="scss">
  .projects {
    list-style-type: none;
    padding: 0;

    @include mediaq($bp-tablet) {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
    }

    &__innerContainer {
      padding: rem(64) 0;
    }

    &__heading {
      font-size: rem(28);
      margin-bottom: rem(38);

      @include mediaq($bp-tablet) {
        font-size: rem(36);
      }
    }
  }
</style>